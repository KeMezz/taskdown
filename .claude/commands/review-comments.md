---
name: PR 코멘트 리뷰
description: PR 코멘트의 타당성을 분석하고 수정 계획을 수립
category: 코드 리뷰
tags: [pr, review, analysis]
---

# PR 코멘트 분석 커맨드

**인자**: $ARGUMENTS (PR 번호, 예: "123" 또는 "#123")

## 가이드라인

- 각 코멘트를 수용/거부 편향 없이 객관적으로 분석
- 코드베이스 컨텍스트를 고려하여 타당성 검증
- 주관적 선호와 객관적 이슈를 구분
- 구체적이고 실행 가능한 수정 계획 수립

## 중요: 서브에이전트 사용 필수

**반드시 Task tool을 사용**하여 코멘트 분석을 수행해야 합니다.

- 각 코멘트 또는 코멘트 스레드 → 1개의 서브에이전트 (subagent_type: "general-purpose")
- **독립적인 코멘트는 단일 응답에서 여러 Task tool을 병렬로 호출**
- 서브에이전트는 관련 코드 파일을 읽고 지적 사항을 검증

## 실행 단계

### 1단계: PR 정보 수집

```bash
# PR 번호 추출 (# 제거)
PR_NUMBER=$(echo "$ARGUMENTS" | sed 's/#//')

# PR 상세 정보 조회
gh pr view $PR_NUMBER --json title,body,url,author,state

# 모든 리뷰 코멘트 조회
gh api repos/{owner}/{repo}/pulls/$PR_NUMBER/comments --paginate

# PR 리뷰 요약 조회
gh pr view $PR_NUMBER --json reviews
```

### 2단계: 서브에이전트로 코멘트 분석

**실행: Task tool을 사용하여 서브에이전트를 병렬로 생성**

각 코멘트에 대해 Task tool 호출:

```
Task tool:
  - description: "PR 코멘트 분석: [간략한 주제]"
  - subagent_type: "general-purpose"
  - prompt: |
      PR 코멘트 분석 요청:

      **코멘트 내용**: [comment body]
      **파일 경로**: [file path]
      **라인 번호**: [line number]

      다음을 수행하세요:
      1. 해당 파일의 관련 코드를 읽어라
      2. 코멘트의 지적이 기술적으로 타당한지 검증하라
      3. 프로젝트 컨벤션(.claude/rules/)을 참고하라

      결과를 다음 형식으로 반환:
      - 판정: ✅ 타당 / ⚠️ 부분 타당 / ❌ 부당 / 💬 논의 필요
      - 근거: [분석 근거]
      - 조치: [수정 필요시 구체적 액션]
```

**판정 카테고리:**

| 판정 | 의미 | 조치 |
|------|------|------|
| ✅ 타당 | 지적이 정확하며 수정 필요 | 수정 계획에 포함 |
| ⚠️ 부분 타당 | 일부 타당하나 과장되었거나 추가 논의 필요 | 응답 초안 작성 |
| ❌ 부당 | 오해에 기반하거나 잘못된 지적 | 반박 근거 제시 |
| 💬 논의 필요 | 리뷰어에게 추가 확인 필요 | 질문 작성 |

### 3단계: 수정 계획 수립

서브에이전트 분석 결과를 종합하여 다음 형식으로 정리:

```markdown
## PR #[번호] 리뷰 분석 결과

### 요약
- 총 코멘트: N개
- ✅ 타당: N개
- ⚠️ 부분 타당: N개
- ❌ 부당: N개
- 💬 논의 필요: N개

### 상세 분석

#### 코멘트 1: [간략한 설명]
- **작성자**: @reviewer
- **위치**: path/to/file.ts:L42
- **지적 내용**: [요약]
- **판정**: ✅ 타당 / ⚠️ 부분 타당 / ❌ 부당 / 💬 논의 필요
- **근거**: [판정 이유]
- **조치**: [필요한 액션]

### 수정 계획

#### 우선순위 1: 필수 수정
- [ ] 태스크 1 설명

#### 우선순위 2: 개선 사항
- [ ] 태스크 2 설명

#### 우선순위 3: 선택/스타일
- [ ] 태스크 3 설명

### 응답 초안
[부당하거나 부분 타당한 코멘트에 대한 응답 초안]
```

## 서브에이전트 병렬 실행 패턴

여러 코멘트 분석 시, **단일 응답에서 여러 Task tool을 동시에 호출**:

```yaml
# 한 번의 응답에서 병렬 실행
Task 1: "PR 코멘트 분석: 타입 안전성"
  - 파일: src/utils.ts
  - 코멘트: "타입 단언 대신 타입 가드 사용 권장"

Task 2: "PR 코멘트 분석: 에러 처리"
  - 파일: src/api.ts
  - 코멘트: "에러 핸들링 누락"

Task 3: "PR 코멘트 분석: 네이밍"
  - 파일: src/hooks.ts
  - 코멘트: "함수명이 명확하지 않음"
```

## 최종 출력

분석 완료 후 다음을 제공:

1. **분석 요약**: 모든 코멘트의 판정 결과
2. **수정 계획**: TodoWrite로 우선순위별 태스크 등록
3. **응답 초안**: 논의가 필요한 코멘트에 대한 응답
4. **다음 단계**: 사용자에게 수정 진행 여부 확인

## 참고 사항

- 복잡한 아키텍처 관련 코멘트는 심층 분석 수행
- `.claude/rules/` 디렉토리의 프로젝트 컨벤션 참조
- 개별 코멘트뿐 아니라 PR 전체 맥락 고려
